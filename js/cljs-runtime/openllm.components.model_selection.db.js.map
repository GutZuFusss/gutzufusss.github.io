{"version":3,"sources":["openllm/components/model_selection/db.cljs"],"mappings":"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","names":["var_args","args__5775__auto__","len__5769__auto__","i__5770__auto__","argseq__5776__auto__","cljs.core/IndexedSeq","openllm.components.model-selection.db/key-seq","seq29432","self__5755__auto__","cljs.core/seq","more-keys","cljs.core.into","openllm.components.model-selection.db/loading-text","cljs.spec.alpha/def-impl","cljs.spec.alpha.every_impl","G__29434","cljs.spec.alpha/and-spec-impl","p1__29433#","cljs.core/string?","cljs.core._EQ_","cljs.core/vector?","G__29435","cljs.core/boolean?","cljs.spec.alpha/map-spec-impl","G__29436","cljs.core/map?","cljs.core/contains?","or__5045__auto__","cljs.spec.alpha.tuple_impl","i__13252__auto__","v__13253__auto__","cljs.core.nth","G__29437","cljs.core/keyword?","G__29439","p1__29438#","cljs.core/Keyword","and__5043__auto__","G__29440","openllm.components.model-selection.db/initial-db","re-frame.core/dispatch"],"sourcesContent":["(ns openllm.components.model-selection.db\r\n  \"The branch of the `app-db` that saves data related to the model-selection view.\r\n   This includes the current model selection, as well as the data for all available\r\n   models.\r\n   The path to this branch can be expressed as:\r\n   *root -> components -> model-selection*\"\r\n  (:require [re-frame.core :as rf]\r\n            [clojure.spec.alpha :as s]))\r\n\r\n(defn key-seq\r\n  [& more-keys]\r\n  (into [:components-db :model-selection-db] more-keys))\r\n\r\n(def loading-text \"Loading...\")\r\n\r\n(declare get-all-models)\r\n\r\n\r\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\r\n;;                Spec                ;;\r\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\r\n(s/def ::vec-of-runtimes? (s/coll-of\r\n                           (s/and string?\r\n                                  #(or (= % \"pt\")\r\n                                       (= % \"flax\")  ;; all available runtimes\r\n                                       (= % \"tf\")))\r\n                           :kind vector?))\r\n\r\n(s/def ::model_id (s/coll-of string? :kind vector?))                   ;; model_id is a vector of all models for a given model_type\r\n(s/def ::url string?)                                                  ;; url to the model's page\r\n(s/def ::requires_gpu boolean?)                                        ;; whether the model requires a gpu\r\n(s/def ::runtime_impl ::vec-of-runtimes?)                              ;; supported runtimes\r\n(s/def ::installation string?)                                         ;; installation instructions (pip command)\r\n(s/def ::model-spec (s/keys :req-un [::model_id ::url ::requires_gpu   ;; the spec for a single model (aggregates all the above)\r\n                                     ::runtime_impl ::installation]))\r\n(s/def ::all-models #(or loading-text                                  ;; -- this is the case when the file with the model data has not been loaded yet by the ::set-model-data effect\r\n                         (s/map-of keyword? ::model-spec)))            ;; map of all models\r\n\r\n(s/def ::selected-model (s/keys :req-un\r\n                                [::model-type #(or (keyword? %)        ;; currently selected model-id and model-type\r\n                                                   (= % loading-text)) ;; -- same as above\r\n                                 ::model-id string?]))\r\n\r\n(s/def ::model-selection-db (s/keys :req-un [::all-models\r\n                                             ::selected-model]))       ;; the spec of the model-selection-db\r\n\r\n(defn initial-db\r\n  []\r\n  (rf/dispatch [:slurp-model-data-json])\r\n  {:all-models loading-text ;; will be overwritten by the event dispatched above\r\n   :selected-model {:model-type :chatglm\r\n                    :model-id \"thudm/chatglm\"}})\r\n"]}