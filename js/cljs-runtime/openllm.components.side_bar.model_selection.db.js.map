{"version":3,"sources":["openllm/components/side_bar/model_selection/db.cljs"],"mappings":"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","names":["var_args","args__5775__auto__","len__5769__auto__","i__5770__auto__","argseq__5776__auto__","cljs.core/IndexedSeq","openllm.components.side-bar.model-selection.db/key-seq","seq33346","self__5755__auto__","cljs.core/seq","more-keys","cljs.core.into","openllm.components.side-bar.model-selection.db/loading-text","cljs.spec.alpha/def-impl","cljs.spec.alpha.every_impl","G__33348","cljs.spec.alpha/and-spec-impl","p1__33347#","cljs.core/string?","cljs.core._EQ_","cljs.core/vector?","G__33349","cljs.core/boolean?","cljs.spec.alpha/map-spec-impl","G__33350","cljs.core/map?","cljs.core/contains?","or__5045__auto__","cljs.spec.alpha.tuple_impl","i__13252__auto__","v__13253__auto__","cljs.core.nth","G__33351","cljs.core/keyword?","G__33353","p1__33352#","cljs.core/Keyword","and__5043__auto__","G__33354","openllm.components.side-bar.model-selection.db/initial-db","re-frame.core/dispatch"],"sourcesContent":["(ns openllm.components.side-bar.model-selection.db\n  \"The branch of the `app-db` that saves data related to the model-selection view.\n   This includes the current model selection, as well as the data for all available\n   models.\n   The path to this branch can be expressed as:\n   *root -> components -> side-bar -> model-selection*\"\n  (:require [re-frame.core :as rf]\n            [clojure.spec.alpha :as s]))\n\n(defn key-seq\n  \"Returns the key sequence to access the model-selection-db This is useful for\n   `assoc-in` and `get-in`. The `more-keys` argument is optional and can be\n   used to access a sub-key of the model-selection-db\n   Returns the key sequence to access the model-selection-db\"\n  [& more-keys]\n  (into [:components-db :side-bar-db :model-selection-db] more-keys))\n\n(def loading-text \"Loading...\")\n\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;;                Spec                ;;\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n(s/def ::vec-of-runtimes? (s/coll-of\n                           (s/and string?\n                                  #(or (= % \"pt\")\n                                       (= % \"flax\")  ;; all available runtimes\n                                       (= % \"tf\")))\n                           :kind vector?))\n\n(s/def ::model_id (s/coll-of string? :kind vector?))                   ;; model_id is a vector of all models for a given model_type\n(s/def ::url string?)                                                  ;; url to the model's page\n(s/def ::requires_gpu boolean?)                                        ;; whether the model requires a gpu\n(s/def ::runtime_impl ::vec-of-runtimes?)                              ;; supported runtimes\n(s/def ::installation string?)                                         ;; installation instructions (pip command)\n(s/def ::model-spec (s/keys :req-un [::model_id ::url ::requires_gpu   ;; the spec for a single model (aggregates all the above)\n                                     ::runtime_impl ::installation]))\n(s/def ::all-models #(or loading-text                                  ;; -- this is the case when the file with the model data has not been loaded yet by the ::set-model-data effect\n                         (s/map-of keyword? ::model-spec)))            ;; map of all models\n\n(s/def ::selected-model (s/keys :req-un\n                                [::model-type #(or (keyword? %)        ;; currently selected model-id and model-type\n                                                   (= % loading-text)) ;; -- same as above\n                                 ::model-id string?]))\n\n(s/def ::model-selection-db (s/keys :req-un [::all-models\n                                             ::selected-model]))       ;; the spec of the model-selection-db\n\n(defn initial-db\n  \"Initial values for this branch of the app-db.\n   Triggers the loading of the model data by dispatching the `:slurp-model-data-json`\n   event.\" \n  []\n  (rf/dispatch [:slurp-model-data-json])\n  (rf/dispatch [:fetch-metadata-endpoint])\n  {:all-models loading-text ;; will be overwritten by the event dispatched above\n   :selected-model {:model-type loading-text\n                    :model-id loading-text}})\n\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;;           Rich Comments            ;;\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n(comment\n  ;; check if initial-db is valid\n  (s/valid? ::model-selection-db (initial-db)))\n"]}